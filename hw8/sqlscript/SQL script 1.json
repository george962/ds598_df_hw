{
	"name": "SQL script 1",
	"properties": {
		"content": {
			"query": "/*\nCREATE EXTERNAL DATA SOURCE MyDataSource\nWITH (\n    LOCATION = 'https://ds598storage.blob.core.windows.net/container-ds598'\n);\n*/\n\n\n/*\nCREATE EXTERNAL FILE FORMAT ParquetFileFormat\nWITH (\n    FORMAT_TYPE = PARQUET\n);\n*/\n\n\n\nCREATE EXTERNAL TABLE ExternalAirPollution (\n    lon FLOAT,\n    lat FLOAT,\n    aqi INT,\n    co FLOAT,\n    no INT,  \n    no2 FLOAT,\n    o3 FLOAT,\n    so2 FLOAT,\n    pm2_5 FLOAT,\n    pm10 FLOAT,\n    nh3 FLOAT,\n    corrected_timestamp FLOAT,  -- Proper data type mapping\n    location VARCHAR(100),\n    date_time VARCHAR(100), \n    id VARCHAR(100),\n    us_aqi INT,\n    o3_8hr FLOAT,  \n    o3_1hr FLOAT,  \n    pm2_5_24hr FLOAT,  \n    pm10_24hr FLOAT,  \n    co_8hr FLOAT,  \n    so2_1hr FLOAT,  \n    so2_24hr FLOAT,  \n    no2_1hr FLOAT  \n)\nWITH (\n    LOCATION = '/gold/processed_air_pollution/',\n    DATA_SOURCE = MyDataSource,\n    FILE_FORMAT = ParquetFileFormat\n);\nGO\n\n\n\nCREATE EXTERNAL TABLE ExternalWeather ( --if your variable names differ, edit it accordingly\n feels_like FLOAT,\n humidity FLOAT,\n pressure FLOAT,\n temp FLOAT,\n temp_max FLOAT,\n temp_min FLOAT,\n wind_deg FLOAT,\n wind_speed FLOAT,\n clouds_all FLOAT,\n date_time DATETIME,\n location VARCHAR(100),\n id VARCHAR(100),\n temp_C FLOAT,\n temp_min_C FLOAT,\n temp_max_C FLOAT,\n feels_like_C FLOAT,\n feels_like_F FLOAT,\n temp_min_F FLOAT,\n temp_max_F FLOAT,\n lon FLOAT,\n lat FLOAT,\n weather_id_value VARCHAR(100),\n weather_main_value VARCHAR(100),\n weather_description_value VARCHAR(100),\n weather_icon_value VARCHAR(100),\n corrected_timestamp FLOAT\n )\nWITH (\n    LOCATION = '/gold/processed_weather/part-00000-tid-4100968858188990993-cbc4cb0a-7479-496e-af75-29b70aec4ece-41-1-c000.snappy.parquet',\n    DATA_SOURCE = MyDataSource,\n    FILE_FORMAT = ParquetFileFormat\n);\nGO\n\n\n\nCREATE EXTERNAL TABLE ExternalAggWeather (\n    date VARCHAR(100),  -- Changed from DATE to VARCHAR(100) to match string data type in Parquet\n    avg_temp_F FLOAT,\n    avg_humidity FLOAT,\n    avg_wind_speed FLOAT,\n    max_temp_F FLOAT,\n    min_temp_F FLOAT,\n    weather_records BIGINT  -- Changed from INT to BIGINT to match int64 in Parquet\n)\nWITH (\n    LOCATION = '/gold/agg_weather/',\n    DATA_SOURCE = MyDataSource,\n    FILE_FORMAT = ParquetFileFormat\n);\nGO\n\n\nCREATE EXTERNAL TABLE ExternalAggWeatherConditions (\n    date VARCHAR(100),  -- Changed from DATE to VARCHAR(100) to match string data type in Parquet\n    weather_main_value VARCHAR(100),\n    count BIGINT  -- Changed from INT to BIGINT to match int64 in Parquet\n)\nWITH (\n    LOCATION = '/gold/agg_weather_conditions/',\n    DATA_SOURCE = MyDataSource,\n    FILE_FORMAT = ParquetFileFormat\n);\nGO\n\n\nCREATE EXTERNAL TABLE ExternalAggTempExtremes (\n    date VARCHAR(100),  -- Changed from DATE to VARCHAR(100) to match string data type in Parquet\n    max_temp_F FLOAT,   -- Stays as FLOAT because double maps to FLOAT in SQL\n    min_temp_F FLOAT    -- Stays as FLOAT because double maps to FLOAT in SQL\n)\nWITH (\n    LOCATION = '/gold/agg_temp_extremes/',\n    DATA_SOURCE = MyDataSource,\n    FILE_FORMAT = ParquetFileFormat\n);\nGO\n\n\nCREATE EXTERNAL TABLE ExternalAggAQI (\n    date VARCHAR(100),    -- Changed from DATE to VARCHAR(100) to match string data type in Parquet\n    avg_us_aqi FLOAT      -- Stays as FLOAT because double maps to FLOAT in SQL\n)\nWITH (\n    LOCATION = '/gold/agg_aqi/',\n    DATA_SOURCE = MyDataSource,\n    FILE_FORMAT = ParquetFileFormat\n);\nGO\n\n\nCREATE EXTERNAL TABLE ExternalAggPollutants (\n    date VARCHAR(100),     -- Changed from DATE to VARCHAR(100) to match string data type in Parquet\n    avg_co FLOAT,          -- Stays as FLOAT because double maps to FLOAT in SQL\n    avg_no2 FLOAT,         \n    avg_o3 FLOAT,          \n    avg_so2 FLOAT,         \n    avg_pm2_5 FLOAT,       \n    avg_pm10 FLOAT         \n)\nWITH (\n    LOCATION = '/gold/agg_pollutants/',\n    DATA_SOURCE = MyDataSource,\n    FILE_FORMAT = ParquetFileFormat\n);\nGO\n\n\nCREATE EXTERNAL TABLE ExternalHighPollutionEvents (\n    date VARCHAR(100),              -- Changed from DATE to VARCHAR(100) to match string data type in Parquet\n    high_pollution_events INT       -- Stays as INT, can be kept as INT if values are within the range of INT\n)\nWITH (\n    LOCATION = '/gold/agg_high_pollution_events/',\n    DATA_SOURCE = MyDataSource,\n    FILE_FORMAT = ParquetFileFormat\n);\nGO\n\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "SQL_Pool",
				"poolName": "SQL_Pool"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}